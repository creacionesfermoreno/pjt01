
@{
    ViewBag.Title = "pagospersonal";
    Layout = "~/Views/Shared/__LayoutAppFitPlataformaFit.cshtml";
}

<link href="@Url.Content("~/Content/cssKendo/kendo.common.min.css")" rel="stylesheet" />
<link href="@Url.Content("~/Content/cssKendo/kendo.dataviz.default.min.css")" rel="stylesheet" />
<link href="@Url.Content("~/Content/cssKendo/kendo.dataviz.min.css")" rel="stylesheet" />
<link href="@Url.Content("~/Content/cssKendo/kendo.default.min.css")" rel="stylesheet" />


<style>


    .small-box {
        border-radius: .25rem;
        box-shadow: 0 0 1px rgba(0,0,0,.125), 0 1px 3px rgba(0,0,0,.2);
        display: block;
        margin-bottom: 20px;
        position: relative;
    }

        .small-box > .inner {
            padding: 10px;
        }

        .small-box h3, .small-box p {
            z-index: 5;
        }

        .small-box h3 {
            font-size: 2.2rem;
            font-weight: 700;
            margin: 0 0 10px 0;
            padding: 0;
            white-space: nowrap;
        }

        .small-box p {
            font-size: 1rem;
        }

        .small-box .icon {
            color: rgba(0,0,0,.15);
            z-index: 0;
        }

        .small-box > .small-box-footer {
            background: rgba(0,0,0,.1);
            color: rgba(255,255,255,.8);
            display: block;
            padding: 3px 0;
            position: relative;
            text-align: center;
            text-decoration: none;
            z-index: 10;
        }

        .small-box .icon > i.fa, .small-box .icon > i.fab, .small-box .icon > i.far, .small-box .icon > i.fas, .small-box .icon > i.glyphicon, .small-box .icon > i.ion {
            font-size: 70px;
            top: 20px;
        }

        .small-box .icon > i {
            font-size: 90px;
            position: absolute;
            right: 15px;
            top: 15px;
            transition: all .3s linear;
        }

        .small-box:hover {
            text-decoration: none;
        }

    .k-block, .k-button, .k-textbox, .k-drag-clue, .k-touch-scrollbar, .k-window, .k-window-titleless .k-window-content, .k-window-action, .k-inline-block, .k-grid .k-filter-options, .k-grouping-header .k-group-indicator, .k-autocomplete, .k-multiselect, .k-combobox, .k-dropdown, .k-dropdown-wrap, .k-datepicker, .k-timepicker, .k-colorpicker, .k-datetimepicker, .k-notification, .k-numerictextbox, .k-picker-wrap, .k-numeric-wrap, .k-colorpicker, .k-list-container, .k-calendar-container, .k-calendar td, .k-calendar .k-link, .k-treeview .k-in, .k-editor-inline, .k-tooltip, .k-tile, .k-slider-track, .k-slider-selection, .k-upload {
        border-radius: 3px;
    }

    .modal-body {
    }

    .modal-backdrop {
        display: none;
    }

    .card-body {
        margin-top: -5px;
        margin-bottom: -5px;
    }

    .k-dropdown .k-input, .k-selectbox .k-input {
        /* background: none; */
        background-color: #fff;
        font-weight: bold;
    }

    .k-dropdown-wrap .k-input, .k-picker-wrap .k-input, .k-numeric-wrap .k-input {
        border-radius: 3px 0 0 3px;
        font-weight: bold;
    }

    .k-autocomplete {
        background-image: url(textures/highlight.png);
        background-image: none,linear-gradient(to bottom,#e2e1e199 0,#e2e1e199 100%);
        background-position: 50% 50%;
        background-color: #e3e3e3;
        border: 1px solid #cac9c9;
        color: #fff;
    }

    .k-header, .k-grid-header, .k-toolbar, .k-dropdown-wrap, .k-picker-wrap, .k-numeric-wrap, .k-grouping-header, .k-pager-wrap, .k-textbox, .k-button, .k-progressbar, .k-draghandle, .k-state-highlight, .k-tabstrip-items .k-item, .k-panelbar .k-tabstrip-items .k-item, .km-pane-wrapper > .km-pane > .km-view > .km-content {
        background-image: url(textures/highlight.png);
        background-image: none,-webkit-linear-gradient(top,#0075ff 0,#0075ff 100%);
        background-image: none,-moz-linear-gradient(top,#0075ff 0,#0075ff 100%);
        background-image: none,-o-linear-gradient(top,#0075ff 0,#0075ff 100%);
        background-image: none,linear-gradient(to bottom,#0075ff 0,#0075ff 100%);
        background-position: 50% 50%;
        background-color: #e3e3e3;
        color: #fff;
    }

        .k-header, .k-grid-header-wrap, .k-grid .k-grouping-header, .k-grid-header, .k-pager-wrap, .k-pager-wrap .k-textbox, .k-pager-wrap .k-link, .k-grouping-header .k-group-indicator, .k-gantt-toolbar .k-state-default {
            border-color: #e8eaee;
            background-color: #0075ff;
            color: #fff;
        }

    .modal {
        display: none;
        background-color: rgba(0, 0, 0, 0.77);
    }

    .k-block, .k-header, .k-grid-header, .k-toolbar, .k-grouping-header, .k-pager-wrap, .k-button, .k-draghandle, .k-treemap-tile, html .km-pane-wrapper .k-header {
        background-color: #0075ff;
        color: #fff;
    }

        .k-grid-header th.k-header > .k-link {
            display: block;
            min-height: 18px;
            line-height: 18px;
            margin: -0.5em -0.6em -0.4em -0.6em;
            padding: .1em .1em .1em .1em;
            overflow: hidden;
            text-overflow: ellipsis;
            color: #fff;
        }

        .k-grid-header table, .k-grid-content table, .k-grid-footer table, .k-grid-content-locked > table {
            table-layout: fixed;
        }



        .k-grid-toolbar:first-child, .k-grouping-header + .k-grid-toolbar {
            border-width: 0 0 1px;
            border-radius: 0px;
            background-color: #d7eafa;
            height: 10px;
        }

    .k-block, .k-header, .k-grid-header, .k-toolbar, .k-grouping-header, .k-pager-wrap, .k-button, .k-draghandle, .k-treemap-tile, html .km-pane-wrapper .k-header {
        background-color: rgba(227, 227, 227, 0);
    }

    #txtFechaInicioProcFreezing .k-header, .k-grid-header, .k-toolbar, .k-dropdown-wrap, .k-picker-wrap, .k-numeric-wrap, .k-grouping-header, .k-pager-wrap, .k-textbox, .k-button, .k-progressbar, .k-draghandle, .k-autocomplete, .k-state-highlight, .k-tabstrip-items .k-item, .k-panelbar .k-tabstrip-items .k-item, .km-pane-wrapper > .km-pane > .km-view > .km-content {
        background-image: url(textures/highlight.png);
        background-image: none,-webkit-linear-gradient(top,#0075ff 0,#0075ff 100%);
        background-image: none,-moz-linear-gradient(top,#0075ff 0,#0075ff 100%);
        background-image: none,-o-linear-gradient(top,#0075ff 0,#0075ff 100%);
        background-image: none,linear-gradient(to bottom,#0075ff 0,#0075ff 100%);
        background-position: 50% 50%;
        background-color: #ffffff;
    }

    .k-state-selected {
        color: #FFFFFF;
        background-color: #0075ff;
        border-color: #0075ff;
    }


    .k-grid tr td {
        border-bottom: 1px solid #eaeaea;
        border-left: 1px solid #eaeaea;
        border-style: solid;
    }

    tr {
        height: 16px;
        font-size: 13px;
    }

    .k-textbox, .k-autocomplete, .k-dropdown-wrap, .k-picker-wrap, .k-numeric-wrap {
        border-width: 1px;
        border-style: solid;
        padding: 0 1.9em 0 0;
        font-weight: bold;
    }

    .k-state-focused.k-state-selected, .k-list > .k-state-focused.k-state-selected, .k-listview > .k-state-focused.k-state-selected, td.k-state-focused.k-state-selected {
        webkit-box-shadow: inset 0 0 3px 4px #0075ff;
        box-shadow: inset 0 0 3px 4px #0075ff;
    }

    .k-state-selected, .k-state-selected:link, .k-state-selected:visited, .k-list > .k-state-selected, .k-list > .k-state-highlight, .k-panel > .k-state-selected, .k-ghost-splitbar-vertical, .k-ghost-splitbar-horizontal, .k-draghandle.k-state-selected:hover, .k-scheduler .k-scheduler-toolbar .k-state-selected, .k-scheduler .k-today.k-state-selected, .k-marquee-color {
        color: #fff;
        background-color: #0075ff;
        border-color: #0075ff;
    }
    /** SPINNER CREATION **/
    .loader {
        position: relative;
        text-align: center;
        margin: 15px auto 35px auto;
        z-index: 9999;
        display: block;
        width: 80px;
        height: 80px;
        border: 10px solid rgba(0, 0, 0, .3);
        border-radius: 50%;
        border-top-color: #000;
        animation: spin 1s ease-in-out infinite;
        -webkit-animation: spin 1s ease-in-out infinite;
    }


    /** MODAL STYLING **/
    .modal-content {
        border-radius: 0px;
        box-shadow: 0 0 20px 8px rgba(0, 0, 0, 0.7);
    }


    [dir=ltr] .modal-lg, [dir=ltr] .modal-xl {
        max-width: 950px;
    }

    a {
        color: transparent;
        text-decoration: none;
    }

    .b-boton-selected {
        background-color: #f70f0f;
        border: 2px #f70f0f solid;
        color: #fff;
        border-radius: 3px;
        font-weight: bold;
        cursor: pointer;
        text-align: center;
    }

    .b-boton-normal {
        background-color: #0075ff;
        color: #fff;
        border-radius: 3px;
        border: 2px #0075ff solid;
        cursor: pointer;
        text-align: center;
        font-weight: bold;
    }
</style>


<div class="page__header page__header-nav mb-0">
    <div class="container-fluid page__container">
        <div class="navbar navbar-secondary navbar-light navbar-expand-sm p-0 d-none d-md-flex" id="secondaryNavbar">
            <ul class="nav navbar-nav">
                <li class="nav-item">
                    <button style="color: #ffffff;background-color: #ff0200;font-size: 1.0rem;border: 0px #ff0200 solid;height: 33px;padding: 5px;cursor:pointer;" class="navbar-toggler navbar-toggler-custom d-flex mr-navbar" type="button" data-toggle="sidebar">
                        Operaciones
                    </button>
                </li>
                <li class="nav-item" data-controlmodulo="45833cdd-55db-4a67-a879-f1ae9353f8bf">
                    <a href="@Url.Action("checking","gestionce",new {id= HttpContext.Current.Request.Cookies["_SubDominio_Business"].Value})" class="nav-link">Clientes</a>
                </li>
                <li class="nav-item" data-controlmodulo="9e69cfd8-b063-44df-a7f2-a3a10d1eb899" style="display:none;">
                    <a class="nav-link " href="@Url.Action("posfitness","pos",new {id= HttpContext.Current.Request.Cookies["_SubDominio_Business"].Value})">Punto de venta</a>
                </li>
                <li class="nav-item" data-controlmodulo="7611dfbe-186f-4abe-8e2e-e64ad7281728" style="display:none;">
                    <a class="nav-link" href="@Url.Action("caja","gestionce",new {id= HttpContext.Current.Request.Cookies["_SubDominio_Business"].Value})">Caja</a>
                </li>
                <li class="nav-item" data-controlmodulo="93c0d848-83aa-45eb-a83a-ded00a6b6e23" style="display:none;">
                    <a class="nav-link" href="@Url.Action("nutricion","gestionce",new {id= HttpContext.Current.Request.Cookies["_SubDominio_Business"].Value})">Medidas y Nutrición</a>
                </li>
                <li class="nav-item" data-controlmodulo="947dc11f-3e14-4fe7-bedc-ae3d81219bee" style="display:none;">
                    <a class="nav-link" href="@Url.Action("Index","inventariofit",new {id= HttpContext.Current.Request.Cookies["_SubDominio_Business"].Value})">Inventario</a>
                </li>

                <li class="nav-item" data-controlmodulo="39497bd3-94ab-4236-a1d4-4623d854f91e" style="display:none;">
                    <a href="@Url.Action("agendacomercial","gestionce",new {id= HttpContext.Current.Request.Cookies["_SubDominio_Business"].Value})" class="nav-link">Agenda Comercial</a>
                </li>
                <li class="nav-item" data-controlmodulo="bbc035e6-68ea-4885-917f-005ad3fcfb66" style="display:none;">
                    <a href="@Url.Action("metascomerciales","gestionce",new {id= HttpContext.Current.Request.Cookies["_SubDominio_Business"].Value})" class="nav-link">Metas</a>
                </li>
                <li class="nav-item" data-controlmodulo="bd61dc23-54d9-4901-9c35-b8d228b3a924" style="display:none;">
                    <a href="@Url.Action("marketing","gestionce",new {id= HttpContext.Current.Request.Cookies["_SubDominio_Business"].Value})" class="nav-link">Marketing</a>
                </li>
                <li class="nav-item" data-controlmodulo="e1eadd0d-39b3-498d-b09b-9b3b28610b9b" style="display:none;">
                    <a href="@Url.Action("informesfit","gestionce",new {id= HttpContext.Current.Request.Cookies["_SubDominio_Business"].Value})" class="nav-link">Informes</a>
                </li>
                <li class="nav-item active" data-controlmodulo="600dabf4-7dc3-4dc0-a0ba-74b782955e52" style="display:none;">
                    <a class="nav-link active" href="@Url.Action("pagospersonal","gestionce",new {id= HttpContext.Current.Request.Cookies["_SubDominio_Business"].Value})">Pagos</a>
                </li>
                <li class="nav-item" data-controlmodulo="b1f65597-fd27-46ca-90d0-a0f2f1039ef7" style="display:none;">
                    <a class="nav-link" href="@Url.Action("finanzas","gestionce",new {id= HttpContext.Current.Request.Cookies["_SubDominio_Business"].Value})">Finanzas</a>
                </li>
                <li class="nav-item" data-controlmodulo="4c01e8de-9440-4927-a2f2-d6241d925c39" style="display:none;">
                    <a class="nav-link" href="@Url.Action("estadisticas","gestionce",new {id= HttpContext.Current.Request.Cookies["_SubDominio_Business"].Value})">Estadísticas</a>
                </li>

            </ul>
        </div>
    </div>
</div>

<div class="container-fluid page__container" style="background-color:#e9ebee;">
    <br />
    <div class="row">
        <div class="col-lg-12">
            <div class="card">
                <div class="card-header card-header-tabs-basic nav" role="tablist" style="background-color:#fff">
                    <a data-controlmodulo="52894632-79fd-43b6-a747-adf3342e2dfd" style="display:none;" href="#divHistorialAsistenciaPersonalFijo" class="active" data-toggle="tab" role="tab" aria-controls="activity_all" aria-selected="true">ASISTENCIAS PERSONAL FIJO</a>
                    <a data-controlmodulo="da4dfe59-57c7-4eb6-9397-7f3e9698ef9a" style="display:none;" href="#divPagosPersonalFijo" data-toggle="tab" role="tab" aria-controls="activity_all" aria-selected="true">PAGOS PERSONAL FIJO</a>
                    <a data-controlmodulo="52894632-79fd-43b6-a747-adf3342e2dfd" style="display:none;" href="#divAsistenciaPagosProfesores" data-toggle="tab" role="tab" aria-controls="activity_all" aria-selected="false">ASISTENCIA Y PAGOS DE PROFESORES</a>
                </div>
                <div class="card-body tab-content" style="background-color: #f5f5f5;">
                    <div class="tab-pane active show  fade" id="divHistorialAsistenciaPersonalFijo">

                        <div class="row">
                            <table style="width: 100%;" border="0">
                                <tr>
                                    <td style="width: 100%;">
                                        <table style="text-align: left; width: 100%;" border="0">
                                            <tr>
                                                <td style="width: 10%;" align="left">
                                                </td>
                                                <td style="width: 90%;">
                                                    <div style="width: 100%;padding: 2px; border-radius: 6px; margin-left: 3px;">
                                                        <table style="width:100%;" border="0">
                                                            <tr>
                                                                <td style="width: 22%;" align="left">
                                                                    <input id="InformePFijo_NombreCompleto" style="width:99%;font-size:12px;" />
                                                                    <input id="InformePFijo_DNI" type="text" class="k-textbox" style="display:none; width: 99%; font-size: 11px; height: 25px;" placeholder="DNI" />
                                                                </td>
                                                                <td style="width: 12%;">
                                                                    <select id="InformePEventual_ddlCargos" style="width: 99%;">
                                                                        <option value="0">TODOS LOS CARGOS</option>
                                                                        <option value="1">Gerente General</option>
                                                                        <option value="2">Asistente de Gerencia</option>
                                                                        <option value="3">Gerente de Recursos Humanos</option>
                                                                        <option value="4">Auxiliar de RR.HH.</option>
                                                                        <option value="5">Gerente de Marketing</option>
                                                                        <option value="6">Auxiliar de Marketing</option>
                                                                        <option value="7">Gerente de Operaciones</option>
                                                                        <option value="8">Auxiliar de Operaciones</option>
                                                                        <option value="9">Jefe de Operaciones</option>
                                                                        <option value="10">Administrativo</option>
                                                                        <option value="11">Cafeteria</option>
                                                                        <option value="12">Gerente de Ventas</option>
                                                                        <option value="13">Jefe de Ventas</option>
                                                                        <option value="14">Supervisor de Ventas</option>
                                                                        <option value="15">Asesor de Ventas</option>
                                                                        <option value="16">Administrador</option>
                                                                        <option value="17">Supervisor de Trainers</option>
                                                                        <option value="18">Trainer</option>
                                                                        <option value="19">Supervisor de Counters</option>
                                                                        <option value="20">Counter</option>
                                                                        <option value="21">Nutricionista</option>
                                                                        <option value="22">Fisioterapia</option>
                                                                        <option value="23">Limpieza o mantenimiento</option>
                                                                    </select>
                                                                </td>
                                                                <td style="width: 11%;">
                                                                    <input id="InformePFijo_FechaInicio" type="text" placeholder="Escriba Fecha Inicio" style="width: 99%;" />
                                                                </td>
                                                                <td style="width: 11%;">
                                                                    <input id="InformePFijo_FechaFin" type="text" placeholder="Escriba Fin" style="width: 99%;" />
                                                                </td>
                                                                <td style="width: 3%;">
                                                                    <button onclick="BuscarInformeAsistenciaPersonalAdministrativo();" type="button" class="btn btn-primary btn-sm" title="Buscar">Buscar Asistencia</button>
                                                                </td>
                                                                <td style="width: 4%;" align="center">
                                                                    <button data-controlmodulo="cb4ce53f-a95d-49fb-8a7b-49cf1486aea8" type="button" class="btn btn-light btn-sm" id="btnExportarGridPersonalFijoAgendaGeneral" onclick="BuscarInformeAsistenciaPersonalAdministrativoExcel();" title="Exportar">Exportar</button>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </div>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2">
                                        <br />
                                        <div class="container-fluid">
                                            <div class="row">
                                                <div class="col-lg-4 col-6">
                                                    <div class="small-box" style="background-color:#0176ff;border:1px #0176ff solid;color:#fff;">
                                                        <div class="inner">
                                                            <h3 style="color:#fff;">#<span style="color:#fff;" id="lblCantidadListarGridH_AsistenciaFijo">0</span></h3>
                                                            <p>NRO ASISTENCIAS</p>
                                                        </div>
                                                        <div class="icon">
                                                            <i class="fas fa-check"></i>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- ./col -->
                                                <div class="col-lg-4 col-6">
                                                    <!-- small box -->
                                                    <div class="small-box" style="background-color:#ff0200;border:1px #ff0200 solid;color:#fff;">
                                                        <div class="inner">
                                                            <h3 style="color:#fff;"><span style="color:#fff;" id="lblTotalMinutosTardeListarGridH_AsistenciaFijo">0</span></h3>
                                                            <p>MINUTOS TARDE</p>
                                                        </div>
                                                        <div class="icon">
                                                            <i class="fas fa-clock"></i>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- ./col -->
                                                <div class="col-lg-4 col-6">

                                                </div>
                                                <!-- ./col -->
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2" >
                                        <table style="width:100%;" border="0">
                                            <tr>
                                                <td valign="top" align="left" style="font-size: 11px; color: #f5f5f5; width: 25%;">
                                                   
                                                </td>
                                                <td style="width: 60%;"></td>
                                                <td style="width: 15%;"></td>
                                                <td valign="top" align="right" style="width: 5%;">
                                                    <select id="ddlPaginacionuspListarAsistenciaPersonalFijoGridGeneral_Paginacion" style="width: 60px; margin-top: 9px;">
                                                        <option value="1">1</option>
                                                    </select>
                                                </td>
                                            </tr>
                                        </table>
                                        <div id="GridListaAsistenciaPersonalFijo" style="width: 100%; margin: 1px;">
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>

                    </div>
                    <div class="tab-pane fade" id="divPagosPersonalFijo">
                        <table style="width: 100%;" border="0">
                            <tr>
                                <td style="width: 100%;">
                                    <table style="text-align: left; width: 100%;" border="0">
                                        <tr>
                                            <td style="width: 30%;" align="left">
                                                <div style="width: 99.3%; background-color: #f5f5f5; padding: 2px; border-radius: 5px; margin-left: 3px;">
                                                    <table style="width: 100%;" border="0">
                                                        <tr>
                                                            <td>
                                                                <input id="PagosPersonalFijo_NombreCompleto" type="text" class="k-textbox" style="display:none;width: 99%; font-size: 11px; height: 25px;" placeholder="Buscar por DNI, Nombre , Apellido , Celular" />
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </div>
                                            </td>
                                            <td style="width: 70%;">
                                                <div style="width: 100%; background-color: #f5f5f5; padding: 2px; border-radius: 6px; margin-left: 3px;">
                                                    <table width="100%" border="0">
                                                        <tr>
                                                            <td style="width: 12%;display:none;" align="left">
                                                                <input id="PagosPersonalFijo_DNI" type="text" class="k-textbox" style="width: 99%; font-size: 11px; height: 25px;" placeholder="DNI" />
                                                            </td>
                                                            <td style="width: 22%;">
                                                                <select id="PagosPersonalFijo_ddlCargos" style="width: 99%;display:none;">
                                                                    <option value="0">CARGOS</option>
                                                                    <option value="1">Gerente General</option>
                                                                    <option value="2">Asistente de Gerencia</option>
                                                                    <option value="3">Gerente de Recursos Humanos</option>
                                                                    <option value="4">Auxiliar de RR.HH.</option>
                                                                    <option value="5">Gerente de Marketing</option>
                                                                    <option value="6">Auxiliar de Marketing</option>
                                                                    <option value="7">Gerente de Operaciones</option>
                                                                    <option value="8">Auxiliar de Operaciones</option>
                                                                    <option value="9">Jefe de Operaciones</option>
                                                                    <option value="10">Administrativo</option>
                                                                    <option value="11">Cafeteria</option>
                                                                    <option value="12">Gerente de Ventas</option>
                                                                    <option value="13">Jefe de Ventas</option>
                                                                    <option value="14">Supervisor de Ventas</option>
                                                                    <option value="15">Asesor de Ventas</option>
                                                                    <option value="16">Administrador</option>
                                                                    <option value="17">Supervisor de Trainers</option>
                                                                    <option value="18">Trainer</option>
                                                                    <option value="19">Supervisor de Counters</option>
                                                                    <option value="20">Counter</option>
                                                                    <option value="21">Nutricionista</option>
                                                                    <option value="22">Fisioterapia</option>
                                                                    <option value="23">Limpieza o mantenimiento</option>
                                                                </select>
                                                            </td>
                                                            <td style="width: 11%;">
                                                                <input id="PagosPersonalFijo_FechaInicio" type="text" cssclass="k-textbox" placeholder="Escriba Fecha Inicio" style="width: 99%;" />
                                                            </td>
                                                            <td style="width: 11%;">
                                                                <input id="PagosPersonalFijo_FechaFin" type="text" cssclass="k-textbox" placeholder="Escriba Fin" style="width: 99%;" />
                                                            </td>
                                                            <td style="width: 4%;">
                                                                <button onclick="BuscarInformeAsistenciaPagosPersonalFijo();" type="button" class="btn btn-primary btn-sm" title="Buscar citas">Buscar Asistencia</button>
                                                            </td>
                                                            <td style="width: 3%;" align="center">
                                                                <button type="button" data_idserver="40" class="btn btn-light btn-sm" id="btnExportarGridPagosPersonalFijo" onclick="BuscarInformePagosPersonalFijoExcel();" title="Exportar">Exportar</button>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </div>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" style="">
                                    <br />
                                    <div class="container-fluid">
                                        <div class="row">
                                            <div class="col-lg-4 col-6">
                                                <div class="small-box" style="background-color:#0176ff;border:1px #0176ff solid;color:#fff;">
                                                    <div class="inner">
                                                        <h3 style="color:#fff;">#<span style="color:#fff;" id="lblCantidadListarGridPagosPersonalFijo">0</span></h3>
                                                        <p>NRO TRABAJADORES</p>
                                                    </div>
                                                    <div class="icon">
                                                        <i class="fas fa-check"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-4 col-6">
                                                <div class="small-box" style="background-color:#0176ff;border:1px #0176ff solid;color:#fff;">
                                                    <div class="inner">
                                                        <h3 style="color:#fff;">s/<span style="color:#fff;" id="lblTotalDescuentoListarGridPagosPersonalFijo">0</span></h3>
                                                        <p>TOTAL DESCUENTO</p>
                                                    </div>
                                                    <div class="icon">
                                                        <i class="fas fa-stop"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- ./col -->
                                            <div class="col-lg-4 col-6">
                                                <!-- small box -->
                                                <div class="small-box" style="background-color:#ff0200;border:1px #ff0200 solid;color:#fff;">
                                                    <div class="inner">
                                                        <h3 style="color:#fff;">s/<span style="color:#fff;" id="lblTotalPagoListarGridPagosPersonalFijo">0.00</span></h3>

                                                        <p>TOTAL PAGO</p>
                                                    </div>
                                                    <div class="icon">
                                                        <i class="fas fa-"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- ./col -->
                                            <div class="col-lg-4 col-6">

                                            </div>
                                            <!-- ./col -->
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" style="padding: 3px 3px 3px 3px;">

                                    <table style="width:100%;" border="0">
                                        <tr>
                                            <td valign="top" align="left" style="font-size: 11px; color: #0075ff; width: 25%;">
                                               
                                            </td>
                                            <td style="width: 60%;"></td>
                                            <td style="width: 15%;"></td>
                                            <td valign="top" align="right" style="width: 5%;">
                                                <select id="ddlPaginacionuspListarPagoPersonalFijoGridGeneral_Paginacion" style="width: 60px; margin-top: 9px;"></select>
                                            </td>
                                        </tr>
                                    </table>
                                    <div id="GridListaPersonalPago" style="width: 100%; ">
                                    </div>
                                </td>
                            </tr>
                        </table>

                    </div>
                    <div class="tab-pane fade" id="divAsistenciaPagosProfesores">
                        <div class="row">
                            <table style="width: 100%;" border="0">
                                <tr>
                                    <td style="width: 100%;">
                                        <table style="text-align: left; width: 100%;" border="0">
                                            <tr>
                                                <td style="width: 10%;" align="left">
                                                </td>
                                                <td style="width: 90%;">
                                                    <div style="width: 100%;padding: 2px; border-radius: 6px; margin-left: 3px;">
                                                        <table style="width:100%;" border="0">
                                                            <tr>
                                                                <td style="width: 22%;" align="left">
                                                                    <input id="InformePEventual_NombreCompleto" style="width: 99%; font-size: 12px;" />
                                                                    <input id="InformePEventual_DNI" type="text" class="k-textbox" style="display:none;width: 99%; font-size: 11px; height: 25px;" placeholder="DNI" />
                                                                </td>
                                                                <td style="width: 12%;">
                                                                    <select id="InformePEventual_ddlDisciplinas" style="width: 99%;"></select>
                                                                </td>
                                                                <td style="width: 11%;">
                                                                    <input id="InformePEventual_FechaInicio" type="text" cssclass="k-textbox" placeholder="Escriba Fecha Inicio" style="width: 99%;" />
                                                                </td>
                                                                <td style="width: 11%;">
                                                                    <input id="InformePEventual_FechaFin" type="text" cssclass="k-textbox" placeholder="Escriba Fin" style="width: 99%;" />
                                                                </td>
                                                                <td style="width: 3%;">
                                                                    <button id="" onclick="BuscarInformeAsistenciaProfesionalFitness();" type="button" class="btn btn-primary btn-sm" title="Buscar citas">Buscar Asistencia</button>
                                                                </td>
                                                                <td style="width: 4%;" align="center">
                                                                    <button data-controlmodulo="a7de3ffa-981a-42ba-8454-77c5b84f58a2" type="button" class="btn btn-light btn-sm" id="btnExportarGridAgendaGeneral" onclick="BuscarInformeAsistenciaProfesionalFitnessExcel();" title="Exportar">Exportar</button>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </div>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2" style="">
                                        <br />
                                        <div class="container-fluid">
                                            <div class="row">
                                                <div class="col-lg-4 col-6">
                                                    <div class="small-box" style="background-color:#0176ff;border:1px #0176ff solid;color:#fff;">
                                                        <div class="inner">
                                                            <h3 style="color:#fff;">#<span style="color:#fff;" id="lblCantidadListarGridAsistenciaProfesoresFitness">0</span></h3>
                                                            <p>NRO ASISTENCIAS</p>
                                                        </div>
                                                        <div class="icon">
                                                            <i class="fas fa-check"></i>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- ./col -->
                                                <div class="col-lg-4 col-6">
                                                    <!-- small box -->
                                                    <div class="small-box" style="background-color:#ff0200;border:1px #ff0200 solid;color:#fff;">
                                                        <div class="inner">
                                                            <h3 style="color:#fff;">s/<span style="color:#fff;" id="lblTotalPagarListarGridAsistenciaProfesoresFitness">0.00</span></h3>
                                                            <p>TOTAL PAGO</p>
                                                        </div>
                                                        <div class="icon">
                                                            <i class="fas fa-"></i>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- ./col -->
                                                <div class="col-lg-4 col-6">
                                                  
                                                </div>
                                                <!-- ./col -->
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2" style="padding: 3px 3px 3px 3px;">

                                        <table width="100%" border="0">
                                            <tr>
                                                <td valign="top" align="left" style="font-size: 11px; color: #f5f5f5; width: 25%;">
                                                 
                                                </td>
                                                <td style="width: 60%;"></td>
                                                <td style="width: 15%;"></td>
                                                <td valign="top" align="right" style="width: 5%;">
                                                    <select id="ddlPaginacionuspListarGridGeneralProfesoresFitness_Paginacion" style="width: 60px; margin-top: 9px;"></select>
                                                </td>
                                            </tr>
                                        </table>
                                        <div id="GridListaAsistenciaProfesionalFitness" style="width: 100%; margin: 1px;">
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

</div>


<div class="modal fade" id="loadMe" tabindex="-1" role="dialog" aria-labelledby="loadMeLabel">
    <br /><br /><br /><br />
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <div class="modal-body text-center">
                <img src="~/Content/appsfit_img/logoappsfitweb.png" style="width:255px;height:125px;" />
                <div class="loader"></div>
                <div clas="loader-txt">
                    <p>Cargando... <br><br><small>Espere por favor, este proceso puede tardar unos minutos</small></p>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @System.Web.Optimization.Scripts.Render("~/Scripts/jquery.min.js")

    @System.Web.Optimization.Scripts.Render("~/Scripts/plugins/jquery-ui/jquery-ui.js")
    @System.Web.Optimization.Scripts.Render("~/Scripts/plugins/jquery-ui/jquery-ui.min.js")


    @System.Web.Optimization.Scripts.Render("~/Scripts/plugins/jsKendo/angular.min.js")
    @System.Web.Optimization.Scripts.Render("~/Scripts/plugins/jsKendo/kendo.all.min.js")


    @System.Web.Optimization.Scripts.Render("~/Resource/UserControl.Helper.js")

    @System.Web.Optimization.Scripts.Render("~/Scripts/bootstrap-notify-master/bootstrap-notify.js")
    @System.Web.Optimization.Scripts.Render("~/Scripts/bootstrap-notify-master/bootstrap-notify.min.js")
    @System.Web.Optimization.Scripts.Render("~/Scripts/jsBootstrap/jquery.bootstrap-growl.js")
    @System.Web.Optimization.Scripts.Render("~/Scripts/maskedinput.js")

    <script type="text/javascript">
        $(document).ready(function () {

            SEGListarPerfilMenu();
            ddlBuscadorListarPersonalAdministrativo();
            ddlBuscadorListarPersonalEventual();
            uspListarDisciplinaSala_Presencial();

            $("#InformePFijo_FechaFin").kendoDatePicker({
                dateInput: false
            });
            $('#InformePFijo_FechaFin').data("kendoDatePicker").value(new Date());

            $("#InformePFijo_FechaInicio").kendoDatePicker({
                dateInput: false
            });
            $('#InformePFijo_FechaInicio').data("kendoDatePicker").value(new Date());

            $("#InformePEventual_ddlCargos").kendoDropDownList({
                filter: "startswith",
            });

            $("#InformePEventual_FechaInicio").kendoDatePicker({
                dateInput: true
            });

            $('#InformePEventual_FechaInicio').data("kendoDatePicker").value(new Date());
            $("#InformePEventual_FechaFin").kendoDatePicker({
                dateInput: true
            });
            $('#InformePEventual_FechaFin').data("kendoDatePicker").value(new Date());

            $("#PagosPersonalFijo_ddlCargos").kendoDropDownList({
                filter: "startswith",
            });

            $('#PagosPersonalFijo_FechaInicio').kendoDatePicker({
                dateInput: true
            });
            $('#PagosPersonalFijo_FechaInicio').data("kendoDatePicker").value(new Date());
            $('#PagosPersonalFijo_FechaFin').kendoDatePicker({
                dateInput: true
            });
            $('#PagosPersonalFijo_FechaFin').data("kendoDatePicker").value(new Date());

        });


       

        function ddlBuscadorListarPersonalAdministrativo() {
            
            var ddlTipoAgenda = $("#InformePFijo_NombreCompleto").kendoDropDownList({
                filter: "startswith",
                optionLabel: "TODOS LOS TRABAJADORES",
                dataTextField: "NombreCompleto",
                dataValueField: "CodigoPersonalAdministrativo",                
                dataSource: {
                    serverFiltering: true,
                    transport: {
                        read: function (options) {
                            $.ajax({
                                type: "POST",
                                url: "/operacionesfit/ListarPersonalAdministrativo",
                                contentType: "application/json; charset=utf-8",
                                dataType: "json",
                                success: function (msg) {
                                    options.success(msg.List);
                                }, complete: function () {

                                }
                            });
                        }
                    }
                }, change: function () {

                }
            }).data("kendoDropDownList");
        }


        function getCookie(cname) {
            var name = cname + "=";
            var ca = document.cookie.split(';');
            for (var i = 0; i < ca.length; i++) {
                var c = ca[i].trim();
                if (c.indexOf(name) == 0) return c.substring(name.length, c.length);
            }
            return "";
        }


        //EXPORTAR ASISTENCIA PERSONAL ADMINISTRATIVO
        function BuscarInformeAsistenciaPersonalAdministrativoExcel() {

            var CodigoUnidadNegocio = getCookie('_CodigoUnidadNegocio_Business');
            var CodigoSede = getCookie('_CodigoSede_Business');
            var NroDocumento = $('#InformePFijo_DNI').val();
            var NombreCompleto = $("#InformePFijo_NombreCompleto").data("kendoDropDownList").value();

            var CodigoCargo = 0;
            if ($('#InformePEventual_ddlCargos').data("kendoDropDownList") != null) {
                CodigoCargo = $('#InformePEventual_ddlCargos').data("kendoDropDownList").value();
            }

            var FechaInicio = kendo.toString($("#InformePFijo_FechaInicio").data('kendoDatePicker').value(), 'MM/dd/yyyy');
            var FechaFin = kendo.toString($("#InformePFijo_FechaFin").data('kendoDatePicker').value(), 'MM/dd/yyyy');

            var data = new FormData();
            data.append('CodigoUnidadNegocio', CodigoUnidadNegocio);
            data.append('CodigoSede', CodigoSede);
            data.append('NroDocumento', NroDocumento);
            data.append('NombreCompleto', NombreCompleto);
            data.append('CodigoCargo', CodigoCargo);
            data.append('FechaInicio', FechaInicio);
            data.append('FechaFin', FechaFin);

            var xhr = new XMLHttpRequest();
            xhr.open('POST', '/ExportarExcel/Appsfit/ExportarAsistenciaPersonalAdministrativo.ashx', true);
            xhr.responseType = 'blob';
            xhr.onload = function (e) {
                if (this.status == 200) {
                    var blob = new Blob([this.response], { type: 'application/vnd.ms-excel' });
                    var downloadUrl = URL.createObjectURL(blob);
                    var a = document.createElement("a");
                    a.href = downloadUrl;
                    a.download = "InformeAsistenciaPersonalFijo.xls";
                    a.style.display = "none";
                    document.body.appendChild(a);
                    a.click();
                } else {
                    alert('Unable to download excel.')
                }
            };
            xhr.send(data);

        }

        //HISTORIAL ASISTENCIA PERSONAL ADMINISTRATIVO
        var BuscarInformeAsistenciaPersonalAdministrativo = function () {
            
            var NroDocumento = $('#InformePFijo_DNI').val();
            var NombreCompleto = $("#InformePFijo_NombreCompleto").data("kendoDropDownList").value();//$('#InformePFijo_NombreCompleto').val();
            
            var CodigoCargo = 0;
            if ($('#InformePEventual_ddlCargos').data("kendoDropDownList") != null) {
                CodigoCargo = $('#InformePEventual_ddlCargos').data("kendoDropDownList").value();
            }
            var PaginaActual = 1;
            if ($('#ddlPaginacionuspListarAsistenciaPersonalFijoGridGeneral_Paginacion').data("kendoDropDownList") != null) {
                PaginaActual = $('#ddlPaginacionuspListarAsistenciaPersonalFijoGridGeneral_Paginacion').data("kendoDropDownList").value();
            }
            
            var entidadDTO = {
                request: {
                    NumeroDocumento: NroDocumento,
                    NombreCompleto: NombreCompleto,
                    FechaInicio: kendo.toString($("#InformePFijo_FechaInicio").data('kendoDatePicker').value(), 'MM/dd/yyyy'),
                    FechaFin: kendo.toString($("#InformePFijo_FechaFin").data('kendoDatePicker').value(), 'MM/dd/yyyy'),
                    CodigoCargo: CodigoCargo
                },
                PageNumber: PaginaActual,
                PageRecords: 100
            };
            
            if (IsUndefinedOrNullOrEmpty(entidadDTO.request.FechaInicio)) {
                entidadDTO.request.FechaInicio = new Date().yyyymmdd('-');
            }
            if (IsUndefinedOrNullOrEmpty(entidadDTO.request.FechaFin)) {
                entidadDTO.request.FechaFin = new Date().yyyymmdd('-');
            }
          
            $("#GridListaAsistenciaPersonalFijo").kendoGrid({
                dataSource: {
                    type: "json",
                    transport: {
                        read: function (options) {
                            $.ajax({
                                type: "POST",
                                data: JSON.stringify(entidadDTO),
                                url: "/gestionce/ListarAsistenciaPersonalAdministrativo",
                                contentType: "application/json; charset=utf-8",
                                dataType: "json",
                                success: function (msg) {
                                    var Lista = msg.List;
                                    var TotalMinutosTarde1 = 0;
                                    var TotalMinutosTarde2 = 0;
                                    if (msg.Paging != null) {
                                        var cantidadPaginas = (msg.Paging.TotalRecord / entidadDTO.PageRecords) + 1;
                                        $('#lblCantidadListarGridH_AsistenciaFijo').html(msg.Paging.TotalRecord);
                                        var htmlOpcion = "";
                                        for (var i = 1; i <= cantidadPaginas; i++) {
                                            htmlOpcion += "<option value='" + i + "'> " + i + " </option>";
                                        }
                                        $('#ddlPaginacionuspListarAsistenciaPersonalFijoGridGeneral_Paginacion').html(htmlOpcion);
                                        $("#ddlPaginacionuspListarAsistenciaPersonalFijoGridGeneral_Paginacion").kendoDropDownList({
                                            change: function () {
                                                BuscarInformeAsistenciaPersonalAdministrativo();
                                            }
                                        });
                                        $('#ddlPaginacionuspListarAsistenciaPersonalFijoGridGeneral_Paginacion').data("kendoDropDownList").value(entidadDTO.PageNumber);

                                    }
                                    else {
                                        $('#lblCantidadListarGridH_AsistenciaFijo').html(Lista.length);
                                    }

                                    for (var i = 0; i < Lista.length; i++) {
                                        Lista[i].Record = (i + 1);
                                        if (Lista[i].FechaHoraIngreso != null && Lista[i].FechaHoraIngreso != '') {
                                            Lista[i].FechaIngreso = kendo.toString(new Date(parseInt(Lista[i].FechaHoraIngreso.replace('/Date(', ''))), 'dd/MM/yyyy');
                                            Lista[i].HoraIngreso = kendo.toString(new Date(parseInt(Lista[i].FechaHoraIngreso.replace('/Date(', ''))), 'HH:mm:ss');
                                            Lista[i].FechaHoraIngreso = kendo.toString(new Date(parseInt(Lista[i].FechaHoraIngreso.replace('/Date(', ''))), 'dd/MM/yyyy HH:mm:ss');
                                        }
                                        if (Lista[i].FechaHoraSalida != null && Lista[i].FechaHoraSalida != '') {
                                            Lista[i].FechaHoraSalida = kendo.toString(new Date(parseInt(Lista[i].FechaHoraSalida.replace('/Date(', ''))), 'HH:mm:ss');
                                        }
                                        if (Lista[i].FechaHoraRefrigerioSalida != null && Lista[i].FechaHoraRefrigerioSalida != '') {
                                            Lista[i].FechaHoraRefrigerioSalida = kendo.toString(new Date(parseInt(Lista[i].FechaHoraRefrigerioSalida.replace('/Date(', ''))), 'HH:mm:ss');
                                        }
                                        if (Lista[i].FechaHoraRefrigerioRetorno != null && Lista[i].FechaHoraRefrigerioRetorno != '') {
                                            Lista[i].FechaHoraRefrigerioRetorno = kendo.toString(new Date(parseInt(Lista[i].FechaHoraRefrigerioRetorno.replace('/Date(', ''))), 'HH:mm:ss');
                                        }

                                        //--TURNO 2
                                        if (Lista[i].FechaHoraIngreso_TurnoTarde != null && Lista[i].FechaHoraIngreso_TurnoTarde != '') {
                                            Lista[i].FechaIngreso_TurnoTarde = kendo.toString(new Date(parseInt(Lista[i].FechaHoraIngreso_TurnoTarde.replace('/Date(', ''))), 'dd/MM/yyyy');
                                            Lista[i].HoraIngreso_TurnoTarde = kendo.toString(new Date(parseInt(Lista[i].FechaHoraIngreso_TurnoTarde.replace('/Date(', ''))), 'HH:mm:ss');
                                            Lista[i].FechaHoraIngreso_TurnoTarde = kendo.toString(new Date(parseInt(Lista[i].FechaHoraIngreso_TurnoTarde.replace('/Date(', ''))), 'dd/MM/yyyy HH:mm:ss');
                                        }
                                        if (Lista[i].FechaHoraSalida_TurnoTarde != null && Lista[i].FechaHoraSalida_TurnoTarde != '') {
                                            Lista[i].FechaHoraSalida_TurnoTarde = kendo.toString(new Date(parseInt(Lista[i].FechaHoraSalida_TurnoTarde.replace('/Date(', ''))), 'HH:mm:ss');
                                        }
                                        if (Lista[i].FechaHoraRefrigerioSalida_TurnoTarde != null && Lista[i].FechaHoraRefrigerioSalida_TurnoTarde != '') {
                                            Lista[i].FechaHoraRefrigerioSalida_TurnoTarde = kendo.toString(new Date(parseInt(Lista[i].FechaHoraRefrigerioSalida_TurnoTarde.replace('/Date(', ''))), 'HH:mm:ss');
                                        }
                                        if (Lista[i].FechaHoraRefrigerioRetorno_TurnoTarde != null && Lista[i].FechaHoraRefrigerioRetorno_TurnoTarde != '') {
                                            Lista[i].FechaHoraRefrigerioRetorno_TurnoTarde = kendo.toString(new Date(parseInt(Lista[i].FechaHoraRefrigerioRetorno_TurnoTarde.replace('/Date(', ''))), 'HH:mm:ss');
                                        }

                                        TotalMinutosTarde1 = parseInt(TotalMinutosTarde1) + parseInt(Lista[i].TardanzaMinutos);
                                        TotalMinutosTarde2 = parseInt(TotalMinutosTarde2) + parseInt(Lista[i].TardanzaMinutos_TurnoTarde);

                                    }

                                    var TotalMinTarde = parseInt(TotalMinutosTarde1) + parseInt(TotalMinutosTarde2);
                                    $('#lblTotalMinutosTardeListarGridH_AsistenciaFijo').html(TotalMinTarde);
                                    options.success(Lista);
                                },
                                complete: function () {

                                },
                                error: function (a, b, c) {
                                    alert(a);
                                }
                            });
                        }
                    },
                },
                selectable: "row",
                sortable: true,
                height: 550,
                columns: [
                    {
                        field: "NumeroDocumento",
                        title: "<center style='color:#fff;'><b>Nro Doc.</b></center>",
                        width: 10,
                        attributes: {
                            style: "font-size:11px;"
                        }
                    }, {
                        field: "NombreCompleto",
                        title: "<b style='color:#fff;'>Nombres</b>",
                        width: 25,
                        attributes: {
                            style: "font-size:11px;text-align: left;"
                        }
                    }, {
                        field: "DescripcionCargo",
                        title: "<b style='color:#fff;'>Cargo</b>",
                        width: 17,
                        attributes: {
                            style: "font-size:10px;text-align: left;"
                        }
                    }, {
                        field: "FechaIngreso",
                        title: "<center style='color:#fff;'><b>Fecha</b></center>",
                        width: 11,
                        attributes: {
                            style: "font-size:11px;text-align: center;"
                        }
                    }, {
                        field: "HoraIngreso",
                        title: "<center style='color:#fff;'><b>Ingreso</b></center>",
                        width: 10,
                        attributes: {
                            style: "font-size:11px;text-align: center;"
                        }
                    }, {
                        field: "FechaHoraRefrigerioSalida",
                        title: "<center style='color:#fff;'><b>B. Inicio</b></center>",
                        width: 10,
                        attributes: {
                            style: "font-size:11px;text-align: center;"
                        }
                    }, {
                        field: "FechaHoraRefrigerioRetorno",
                        title: "<center style='color:#fff;'><b>B. Fin</b></center>",
                        width: 10,
                        attributes: {
                            style: "font-size:11px;text-align: center;"
                        }
                    }, {
                        field: "FechaHoraSalida",
                        title: "<center style='color:#fff;'><b>Salida</b></center>",
                        width: 10,
                        attributes: {
                            style: "font-size:11px;text-align: center;"
                        }
                    }, {
                        field: "TardanzaMinutos",
                        title: "<center style='color:#fff;'><b>M.Tarde</b></center>",
                        width: 8,
                        attributes: {
                            style: "font-size:11px;font-weight:bold;text-align: center;"
                        }
                    },{
                        field: "HoraIngreso_TurnoTarde",
                        title: "<center style='color:#000;'><b>Ingreso</b></center>",
                        width: 10,
                        attributes: {
                            style: "font-size:11px;text-align: center;"
                        }
                    }, {
                        field: "FechaHoraRefrigerioSalida_TurnoTarde",
                        title: "<center style='color:#000;'><b>B. Inicio</b></center>",
                        width: 10,
                        attributes: {
                            style: "font-size:11px;text-align: center;"
                        }
                    }, {
                        field: "FechaHoraRefrigerioRetorno_TurnoTarde",
                        title: "<center style='color:#000;'><b>B. Fin</b></center>",
                        width: 10,
                        attributes: {
                            style: "font-size:11px;text-align: center;"
                        }
                    }, {
                        field: "FechaHoraSalida_TurnoTarde",
                        title: "<center style='color:#000;'><b>Salida</b></center>",
                        width: 10,
                        attributes: {
                            style: "font-size:11px;text-align: center;"
                        }
                    }, {
                        field: "TardanzaMinutos_TurnoTarde",
                        title: "<center style='color:#000;'><b>M.Tarde</b></center>",
                        width: 8,
                        attributes: {
                            style: "font-size:11px;text-align: center;"
                        }
                    }             
                ]
                ,change: function () {
                    var grid = this;
                    grid.select().each(function () {
                        var dataItem = grid.dataItem($(this));
                    });
                }
            });
        };

        //HISTORIAL ASISTENCIA PROFESORES
        function uspListarDisciplinaSala_Presencial() {

            var entidad = {};
            entidad.CodigoSala = 0;//$('input[id="hdCodigoSala"]').val() == '' ? 1 : $('input[id="hdCodigoSala"]').val();

            var metodoCorrecto = function (data) {
                //var content_disciplina = new Array();
                //content_disciplina.push('<option value="0">SELECCIONE DISCIPLINA</option>');
                //for (var i = 0; i < data.length; i++) {
                //    content_disciplina.push('<option value="' + data[i].CodigoDisciplinaSala + '">' + data[i].Disciplina + '</option>');
                //}
                //$('#txtClase_Disciplina').html(content_disciplina.join(' '));

                var options = new Array();
                options.push('<option value="0">SELECCIONE DISCIPLINA</option>');
                if (data.length > 0) {
                    for (var i = 0; i < data.length; i++) {
                        options.push('<option value="' + data[i].CodigoSalaHorario + '">' + data[i].Disciplina.toString().toUpperCase() + '</option>');
                    }
                }
                $('#InformePEventual_ddlDisciplinas').html(options.join(''));
                $("#InformePEventual_ddlDisciplinas").kendoDropDownList();
            };

            var metodoError = function (msg) {
                alert(msg);
            };
            var request = {
                request: entidad
            };

            LlamarAJAX('/gestionce/uspListarDisciplinaSala_Presencial', request, metodoCorrecto, metodoError);
        }

        //LISTAR EN DDL PERSONAL EVENTUAL
        function ddlBuscadorListarPersonalEventual() {

            var ddlTipoAgenda = $("#InformePEventual_NombreCompleto").kendoDropDownList({
                filter: "startswith",
                optionLabel: "TODOS LOS PROFESORES",
                dataTextField: "NombreCompleto",
                dataValueField: "CodigoProfesional",
                dataSource: {
                    serverFiltering: true,
                    transport: {
                        read: function (options) {
                            $.ajax({
                                type: "POST",
                                url: "/gestionce/uspListarPersonalClasesGrupales",
                                contentType: "application/json; charset=utf-8",
                                dataType: "json",
                                success: function (msg) {
                                    options.success(msg.List);
                                }, complete: function () {

                                }
                            });
                        }
                    }
                }, change: function () {

                }
            }).data("kendoDropDownList");
        }

        //EXPORTAR PAGOS Y ASISTENCIA DE PROFESORES
        function BuscarInformeAsistenciaProfesionalFitnessExcel() {

            var CodigoUnidadNegocio = getCookie('_CodigoUnidadNegocio_Business');
            var CodigoSede = getCookie('_CodigoSede_Business');
            var NroDocumento = '';
            var NombreCompleto = $("#InformePEventual_NombreCompleto").data("kendoDropDownList").value();
            var CodigoDisciplina = 0;
            if ($('#InformePEventual_ddlDisciplinas').data("kendoDropDownList") != null) {
                CodigoDisciplina = $('#InformePEventual_ddlDisciplinas').data("kendoDropDownList").value();
            }
            var FechaInicio = kendo.toString($("#InformePEventual_FechaInicio").data('kendoDatePicker').value(), 'MM/dd/yyyy');
            var FechaFin = kendo.toString($("#InformePEventual_FechaFin").data('kendoDatePicker').value(), 'MM/dd/yyyy');

            var data = new FormData();
            data.append('CodigoUnidadNegocio', CodigoUnidadNegocio);
            data.append('CodigoSede', CodigoSede);
            data.append('NroDocumento', NroDocumento);
            data.append('NombreCompleto', NombreCompleto);
            data.append('CodigoDisciplina', CodigoDisciplina);
            data.append('FechaInicio', FechaInicio);
            data.append('FechaFin', FechaFin);

            var xhr = new XMLHttpRequest();
            xhr.open('POST', '/ExportarExcel/Appsfit/ExportarAsistenciaPagosProfesores.ashx', true);
            xhr.responseType = 'blob';
            xhr.onload = function (e) {
                if (this.status == 200) {
                    var blob = new Blob([this.response], { type: 'application/vnd.ms-excel' });
                    var downloadUrl = URL.createObjectURL(blob);
                    var a = document.createElement("a");
                    a.href = downloadUrl;
                    a.download = "InformePagosAsistenciaProfesores.xls";
                    a.style.display = "none";
                    document.body.appendChild(a);
                    a.click();
                } else {
                    alert('Unable to download excel.')
                }
            };
            xhr.send(data);

        }


        var BuscarInformeAsistenciaProfesionalFitness = function () {

            var NroDocumento = $('#InformePEventual_DNI').val();
            var NombreCompleto = $("#InformePEventual_NombreCompleto").data("kendoDropDownList").value();
            var CodigoDisciplina = 0;
            if ($('#InformePEventual_ddlDisciplinas').data("kendoDropDownList") != null) {
                CodigoDisciplina = $('#InformePEventual_ddlDisciplinas').data("kendoDropDownList").value();
            }

            var PaginaActual = 1;
            if ($('#ddlPaginacionuspListarGridGeneralProfesoresFitness_Paginacion').data("kendoDropDownList") != null) {
                PaginaActual = $('#ddlPaginacionuspListarGridGeneralProfesoresFitness_Paginacion').data("kendoDropDownList").value();
            }
            var entidadDTO = {
                request: {
                    NumeroDocumento: NroDocumento,
                    NombreCompleto: NombreCompleto,
                    FechaInicio: kendo.toString($("#InformePEventual_FechaInicio").data('kendoDatePicker').value(), 'MM/dd/yyyy'),
                    FechaFin: kendo.toString($("#InformePEventual_FechaFin").data('kendoDatePicker').value(), 'MM/dd/yyyy'),
                    CodigoDisciplina: CodigoDisciplina
                },
                PageNumber: PaginaActual,
                PageRecords: 100
            };

            if (IsUndefinedOrNullOrEmpty(entidadDTO.request.FechaInicio)) {
                entidadDTO.request.FechaInicio = new Date().yyyymmdd('-');
            }
            if (IsUndefinedOrNullOrEmpty(entidadDTO.request.FechaFin)) {
                entidadDTO.request.FechaFin = new Date().yyyymmdd('-');
            }
            var alto = window.parent.window.innerHeight;

            //alto = alto > 400 ? (alto - 370) : 400;
            alto = 430;
            $("#GridListaAsistenciaProfesionalFitness").kendoGrid({
                dataSource: {
                    type: "json",
                    transport: {
                        read: function (options) {
                            $.ajax({
                                data: JSON.stringify(entidadDTO),
                                type: "POST",
                                url: "/gestionce/ListarInformeProfesores",
                                contentType: "application/json; charset=utf-8",
                                dataType: "json",
                                success: function (msg) {
                                    var Lista = msg.ListProfesores;
                                    var TotalPago = 0;
                                    for (var i = 0; i < Lista.length; i++) {
                                        if (Lista[i].FechaHoraInicioClase != null || Lista[i].FechaHoraInicioClase != '') {
                                            Lista[i].FechaHoraInicioClase = kendo.toString(new Date(parseInt(Lista[i].FechaHoraInicioClase.replace('/Date(', ''))), 'HH:mm tt');
                                        }
                                        TotalPago = parseFloat(TotalPago) + parseFloat(Lista[i].TotalPago);
                                        //if (Lista[i].FechaHoraMarcacionIngreso != null || Lista[i].FechaHoraMarcacionIngreso != '') {
                                        //    Lista[i].FechaHoraMarcacionIngreso = kendo.toString(new Date(parseInt(Lista[i].FechaHoraMarcacionIngreso.replace('/Date(', ''))), 'dd/MM/yyyy HH:mm');
                                        //}
                                        //if (Lista[i].FechaHoraMarcacionSalida != null || Lista[i].FechaHoraMarcacionSalida != '') {
                                        //    Lista[i].FechaHoraMarcacionSalida = kendo.toString(new Date(parseInt(Lista[i].FechaHoraMarcacionSalida.replace('/Date(', ''))), 'dd/MM/yyyy HH:mm');
                                        //}
                                    }

                                    if (msg.Paging != null) {
                                        var cantidadPaginas = (msg.Paging.TotalRecord / entidadDTO.PageRecords) + 1;
                                        $('#lblCantidadListarGridAsistenciaProfesoresFitness').html(msg.Paging.TotalRecord);
                                        var htmlOpcion = "";
                                        for (var i = 1; i <= cantidadPaginas; i++) {
                                            htmlOpcion += "<option value='" + i + "'> " + i + " </option>";
                                        }
                                        $('#ddlPaginacionuspListarGridGeneralProfesoresFitness_Paginacion').html(htmlOpcion);
                                        $("#ddlPaginacionuspListarGridGeneralProfesoresFitness_Paginacion").kendoDropDownList({
                                            change: function () {
                                                BuscarInformeAsistenciaProfesionalFitness();
                                            }
                                        });
                                        $('#ddlPaginacionuspListarGridGeneralProfesoresFitness_Paginacion').data("kendoDropDownList").value(entidadDTO.PageNumber);
                                    }
                                    else {
                                        $('#lblCantidadListarGridAsistenciaProfesoresFitness').html(Lista.length);
                                    }
                                    $('#lblTotalPagarListarGridAsistenciaProfesoresFitness').html(TotalPago.toFixed(2));
                                    options.success(Lista);
                                }, complete: function () {

                                }
                            });
                        }
                    }
                    //,
                    //aggregate: [
                    //    { field: "TotalAlumnos", aggregate: "sum" },
                    //    { field: "TotalAlumnos", aggregate: "count" },
                    //    { field: "TotalAlumnos", aggregate: "average" },
                    //    { field: "CostoPorHora", aggregate: "sum" },
                    //    { field: "Tardanza", aggregate: "sum" },
                    //    { field: "DescuentoPorTardanza", aggregate: "sum" },
                    //    { field: "TotalPago", aggregate: "sum" }
                    //]
                },
                height: alto
                , selectable: "row"
                , columns: [{
                    field: "NombreProfesionalFitness",
                    title: "<b style='color:#fff;'>Profesor</b>",
                    width: 40,
                    attributes: {
                        style: "font-size:11px;text-align: left;"
                    }
                }, {
                    field: "NumeroDocumento",
                    title: "<center style='color:#fff;'><b>Nro Doc.</b></center>",
                    width: 15,
                    attributes: {
                        style: "font-size:11px;text-align:center;"
                    }
                }, {
                    field: "Disciplina",
                    title: "<b style='color:#fff;'>Disciplina</b>",
                    width: 30,
                    attributes: {
                        style: "font-size:11px;text-align: left;"
                    }
                }, {
                    field: "CostoPorClase",
                    title: "<center style='color:#fff;'><b>Costo</b></center>",
                    width: 8,
                    attributes: {
                        style: "font-size:11px;text-align:center;"
                    }
                    //,
                    //footerTemplate: "S/. #:sum#"
                }, {
                    field: "FechaHoraInicioClase",
                    title: "<center style='color:#fff;'><b>Inicio</b></center>",
                    width: 20,
                    attributes: {
                        style: "font-size:11px;text-align:center;"
                    }
                }, {
                    field: "FechaHoraMarcacionIngreso_texto",
                    title: "<center style='color:#fff;'><b>Ingreso</b></center>",
                    width: 20,
                    attributes: {
                        style: "font-size:11px;text-align:center;"
                    }
                }, {
                    field: "FechaHoraMarcacionSalida_texto",
                    title: "<center style='color:#fff;'><b>Salida</b></center>",
                    width: 20,
                    attributes: {
                        style: "font-size:11px;text-align:center;"
                    }
                }, {
                    field: "Tardanza",
                    title: "<center style='color:#fff;'><b>Tardanza</b></center>",
                    width: 12,
                    attributes: {
                        style: "font-size:11px;text-align:center;"
                    }
                    //,
                    //footerTemplate: "#:sum#"
                }, {
                    field: "DescuentoPorTardanza",
                    title: "<center style='color:#fff;'><b>Descuento</b></center>",
                    width: 12,
                    attributes: {
                        style: "font-size:11px;text-align:center;"
                    }
                    //,
                    //footerTemplate: "#:sum#"
                }, {
                    field: "TotalPago",
                    title: "<center style='color:#fff;'><b>Pago total</b></center>",
                    width: 12,
                    attributes: {
                        style: "font-size:11px;text-align:center;"
                    }
                    //,
                    //footerTemplate: "#:sum#"
                }]
                , change: function () {
                    var grid = this;
                    grid.select().each(function () {
                        var dataItem = grid.dataItem($(this));
                    });
                }
            });
        };

        //EXPORTAR ASISTENCIA PERSONAL ADMINISTRATIVO
        function BuscarInformePagosPersonalFijoExcel() {

            var CodigoUnidadNegocio = getCookie('_CodigoUnidadNegocio_Business');
            var CodigoSede = getCookie('_CodigoSede_Business');
            var NroDocumento = $('#PagosPersonalFijo_DNI').val();
            var NombreCompleto = '';
            var CodigoDisciplina = $('#PagosPersonalFijo_ddlCargos').data("kendoDropDownList").value();
            var FechaInicio = kendo.toString($("#PagosPersonalFijo_FechaInicio").data('kendoDatePicker').value(), 'MM/dd/yyyy');
            var FechaFin = kendo.toString($("#PagosPersonalFijo_FechaFin").data('kendoDatePicker').value(), 'MM/dd/yyyy');

            var data = new FormData();
            data.append('CodigoUnidadNegocio', CodigoUnidadNegocio);
            data.append('CodigoSede', CodigoSede);
            data.append('NroDocumento', NroDocumento);
            data.append('NombreCompleto', NombreCompleto);
            data.append('CodigoDisciplina', CodigoDisciplina);
            data.append('FechaInicio', FechaInicio);
            data.append('FechaFin', FechaFin);

            var xhr = new XMLHttpRequest();
            xhr.open('POST', '/ExportarExcel/Appsfit/ExportarPagosPersonalAdministrativo.ashx', true);
            xhr.responseType = 'blob';
            xhr.onload = function (e) {
                if (this.status == 200) {
                    var blob = new Blob([this.response], { type: 'application/vnd.ms-excel' });
                    var downloadUrl = URL.createObjectURL(blob);
                    var a = document.createElement("a");
                    a.href = downloadUrl;
                    a.download = "InformePagosPersonalFijo.xls";
                    a.style.display = "none";
                    document.body.appendChild(a);
                    a.click();
                } else {
                    alert('Unable to download excel.')
                }
            };
            xhr.send(data);

        }


        var BuscarInformeAsistenciaPagosPersonalFijo = function () {
            var NroDocumento = $('#PagosPersonalFijo_DNI').val();
            var NombreCompleto = '';//$('#PagosPersonalFijo_NombreCompleto').val();
            var CodigoDisciplina = $('#PagosPersonalFijo_ddlCargos').data("kendoDropDownList").value();

            var PaginaActual = 1;
            if ($('#ddlPaginacionuspListarPagoPersonalFijoGridGeneral_Paginacion').data("kendoDropDownList") != null) {
                PaginaActual = $('#ddlPaginacionuspListarPagoPersonalFijoGridGeneral_Paginacion').data("kendoDropDownList").value();
            }
            var entidadDTO = {
                request: {
                    NumeroDocumento: NroDocumento,
                    NombreCompleto: NombreCompleto,
                    FechaInicio: kendo.toString($("#PagosPersonalFijo_FechaInicio").data('kendoDatePicker').value(), 'MM/dd/yyyy'),
                    FechaFin: kendo.toString($("#PagosPersonalFijo_FechaFin").data('kendoDatePicker').value(), 'MM/dd/yyyy'),
                    CodigoCargo: CodigoDisciplina
                },
                PageNumber: PaginaActual,
                PageRecords: 100
            };

            if (IsUndefinedOrNullOrEmpty(entidadDTO.request.FechaInicio)) {
                entidadDTO.request.FechaInicio = new Date().yyyymmdd('-');
            }
            if (IsUndefinedOrNullOrEmpty(entidadDTO.request.FechaFin)) {
                entidadDTO.request.FechaFin = new Date().yyyymmdd('-');
            }

            var alto = window.parent.window.innerHeight;
            //alto = alto > 400 ? (alto - 370) : 400;
            alto = 450;
            $("#GridListaPersonalPago").kendoGrid({
                dataSource: {
                    type: "json",
                    transport: {
                        read: function (options) {
                            $.ajax({
                                data: JSON.stringify(entidadDTO),
                                type: "POST",
                                url: "/gestionce/ListarAsistenciaPersonalAdministrativoResumen",
                                contentType: "application/json; charset=utf-8",
                                dataType: "json",
                                success: function (msg) {
                                    var Lista = msg.ListPersonalAdministrativoAsistencia;
                                    var TotalDescuento = 0
                                    var TotalPago = 0
                                    if (msg.Paging != null) {
                                        var cantidadPaginas = (msg.Paging.TotalRecord / entidadDTO.PageRecords) + 1;
                                        $('#lblCantidadListarGridPagosPersonalFijo').html(Lista.length);
                                        var htmlOpcion = "";
                                        for (var i = 1; i <= cantidadPaginas; i++) {
                                            htmlOpcion += "<option value='" + i + "'> " + i + " </option>";
                                        }
                                        $('#ddlPaginacionuspListarPagoPersonalFijoGridGeneral_Paginacion').html(htmlOpcion);
                                        $("#ddlPaginacionuspListarPagoPersonalFijoGridGeneral_Paginacion").kendoDropDownList({
                                            change: function () {
                                                BuscarInformeAsistenciaPagosPersonalFijo();
                                            }
                                        });
                                        $('#ddlPaginacionuspListarPagoPersonalFijoGridGeneral_Paginacion').data("kendoDropDownList").value(entidadDTO.PageNumber);
                                    }
                                    else {
                                        $('#lblCantidadListarGridPagosPersonalFijo').html(Lista.length);
                                    }

                                    for (var i = 0; i < Lista.length; i++) {
                                        TotalDescuento = parseFloat(TotalDescuento) + parseFloat(Lista[i].TotalDescuento);
                                        TotalPago = parseFloat(TotalPago) + parseFloat(Lista[i].TotalNeto);
                                    }

                                    $('#lblTotalDescuentoListarGridPagosPersonalFijo').html(parseFloat(TotalDescuento).toFixed(2));
                                    $('#lblTotalPagoListarGridPagosPersonalFijo').html(parseFloat(TotalPago).toFixed(2));

                                    options.success(Lista);
                                }, complete: function () {

                                }
                            });
                        }
                    }
                },
                height: alto
                , selectable: "row"
                , columns: [{
                    field: "DNI",
                    title: "<center style='color:#fff;'><b>DNI</b></center>",
                    width: 10,
                    attributes: {
                        style: "font-size:11px;text-align:center;"
                    }
                }, {
                    field: "NombreCompleto",
                    title: "<b style='color:#fff;'>Nombres</b>",
                    width: 23,
                    attributes: {
                        style: "font-size:11px;text-align:left;"
                    }
                }, {
                    field: "DescripcionCargo",
                    title: "<b style='color:#fff;'>Cargo</b>",
                    width: 23,
                    attributes: {
                        style: "font-size:11px;text-align: left;"
                    }
                }, {
                    field: "DiasTrabajados",
                        title: "<center title='DIAS TRABAJADOS' style='color:#fff;'><b>Dias Lab.</b></center>",
                    width: 8,
                    attributes: {
                        style: "font-size:11px;text-align: center;"
                    }
                }, {
                    field: "HorasTrabajadasText",
                        title: "<center title='HORAS TRABAJADAS' style='color:#fff;'><b>Hora T.</b></center>",
                    width: 8,
                    attributes: {
                        style: "font-size:11px;text-align: center;"
                    }
                }, {
                    field: "MinutosTardanza",
                    title: "<center title='MINUTOS TARDANZA' style='color:#fff;'><b>Min. Tard</b></center>",
                    width: 8,
                    attributes: {
                        style: "font-size:11px;text-align: center;"
                    }
                }, {
                    field: "TotalDescuento",
                        title: "<center title='TOTAL DESCUENTO POR TARDANZA' style='color:#fff;'><b>Dsto. Tard</b></center>",
                    width: 8,
                    attributes: {
                        style: "font-size:11px;text-align: center;"
                    }
                }, {
                    field: "Sueldo",
                    title: "<center style='color:#fff;'><b>Sueldo</b></center>",
                    width: 8,
                    attributes: {
                        style: "font-size:11px;text-align: center;"
                    }
                }, {
                    field: "SubTotal",
                        title: "<center title='(SUELDO/26 DIAS)*DIAS LAB' style='color:#fff;'><b>Sub Total</b></center>",
                    width: 8,
                    attributes: {
                        style: "font-size:11px;text-align: center;"
                    }
                }, {
                    field: "TotalNeto",
                        title: "<center title='SUBTOTAL-DESCUENTO TARDANZA' style='color:#fff;'><b>Total</b></center>",
                    width: 8,
                    attributes: {
                        style: "font-size:11px;text-align: center;"
                    }
                }]
                , change: function () {
                    var grid = this;
                    grid.select().each(function () {
                        var dataItem = grid.dataItem($(this));
                    });
                }
            });
        };

        function SEGListarPerfilMenu() {

            var entidad = {};

            document.getElementById('loadMe').style.display = 'block';
            $('button[type="button"]').attr("disabled", true);
            var metodoCorrecto = function (msg) {

                $('button[type="button"]').attr("disabled", false);
                document.getElementById('loadMe').style.display = 'none';

                for (var i = 0; i < msg.length; i++) {

                    if (msg[i].Estado) {
                        $('[data-controlmodulo="' + msg[i].CodigoMenu + '"]').show('fast');

                    }
                }

            };
            var metodoError = function (msg) {
                alert(msg);
            };
            var request = {
                //request: entidad
            };
            LlamarAJAX("/gestionce/SEGListarPerfilMenu", request, metodoCorrecto, metodoError);

        }
    </script>

}