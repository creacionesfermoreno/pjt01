<!DOCTYPE html>

@{
    Layout = null;
}
<html lang="en">
<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Inicio</title>
    <link href="@Url.Content("~/Content/app/css/slim.css")" rel="stylesheet" />
    <link href="@Url.Content("~/Content/app/lib/Ionicons/css/ionicons.css")" rel="stylesheet" />

    <style>
        .btn-signin {
            font-weight: 500;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 40px;
            border: 0;
            min-height: 40px;
            background-image: linear-gradient(to right, #ff0200 35%, #ffab28 100%);
            background-repeat: repeat-x;
        }

        .btn-danger {
            border: 0;
            background-image: linear-gradient(to right, #ff0200 35%, #ffab28 100%);
            background-repeat: repeat-x;
        }

        .slim-logo {
            color: #ff2308
        }

        .borderValidacionFacebook {
            border: 1px #25c125 solid;
        }
    </style>
    <style>
        :root {
            --urlLogoPagina: @HttpContext.Current.Request.Cookies["_LogoTipo"].Value;
            --colorPrincipal: @HttpContext.Current.Request.Cookies["_ColorEmpresa_PersonaFit"].Value;
        }
    </style>
</head>
<body>
    <!-- Facebook Pixel Code -->
    <script>
        !function (f, b, e, v, n, t, s) {
            if (f.fbq) return; n = f.fbq = function () {
                n.callMethod ?
                n.callMethod.apply(n, arguments) : n.queue.push(arguments)
            };
            if (!f._fbq) f._fbq = n; n.push = n; n.loaded = !0; n.version = '2.0';
            n.queue = []; t = b.createElement(e); t.async = !0;
            t.src = v; s = b.getElementsByTagName(e)[0];
            s.parentNode.insertBefore(t, s)
        }(window, document, 'script',
            'https://connect.facebook.net/en_US/fbevents.js');
        fbq('init', '248722293339811');
        fbq('track', 'PageView');
    </script>
    <noscript>
        <img height="1" width="1" style="display:none"
             src="https://www.facebook.com/tr?id=248722293339811&ev=PageView&noscript=1" />
    </noscript>
    <!-- End Facebook Pixel Code -->
    <script>

        //SDK FACEBOOK LOGIN
        (function (d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) { return; }
            js = d.createElement(s); js.id = id;
            js.src = "https://connect.facebook.net/es_LA/all.js";
            d.getElementsByTagName('head')[0].appendChild(js);
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));




    </script>
    <div class="signin-wrapper" style="background-color:#e2e2e2">

        <div class="signin-box signup">
            <h2 class="slim-logo" style="color:var(--colorPrincipal);">Reservas Online<span>.</span></h2>
            <h3 class="signin-title-primary">Registrarse es gratis y solo toma un minuto.</h3>
            <h5 class="signin-title-secondary lh-4">recuerda que debes de tener una membresia activa</h5>
            <div class="row row-xs mg-b-10">
                <div class="col-12 mg-t-10 mg-sm-t-0" style="display:none;">
                    <button id="validarFacebook" class="btn btn-facebook btn-block" style="background-color:#fff;border: 1px solid #1877f2;color:#1877f2;font-weight: bold;">
                        <i class="fa ion-social-facebook" style=""></i>
                        Validar mi Facebook
                    </button>
                </div>
                <div class="col-2" style="display:none;">
                    <div class="media">
                        <div class="tx-center">
                            <img id="imgValidacion" src="http://via.placeholder.com/500x500" style="width:42px;" class="img-fluid rounded-circle" alt="">
                        </div><!-- tx-center -->
                    </div>
                </div>
            </div><!-- row -->
            <div class="row row-xs mg-b-10">
                <div class="col-sm"><input id="txtUsuario_Nombres" type="text" name="request.Nombres" class="form-control" placeholder="Ingrese nombres"></div>
                <div class="col-sm mg-t-10 mg-sm-t-0"><input id="txtUsuario_Apellidos" type="text" name="request.Apellidos" class="form-control" placeholder="Ingrese apellidos"></div>
            </div><!-- row -->
            <div class="row row-xs mg-b-10">
                <div class="col-sm mg-t-10 mg-sm-t-0"><input id="txtUsuario_Identificacion" type="text" name="request.Identificacion" class="form-control" placeholder="Ingrese DNI/CE/CC"></div>
                <div class="col-sm"><input id="txtUsuario_Email" type="email" name="request.Email" class="form-control" placeholder="Ingrese su correo"></div>
            </div><!-- row -->
            <div class="row row-xs mg-b-10">
                <div class="col-sm"><input id="txtUsuario_PasswordHash" type="password" name="request.PasswordHash" class="form-control" placeholder="Ingrese su contraseña"></div>
                <div class="col-sm mg-t-10 mg-sm-t-0"><input id="txtUsuario_PasswordConfirmacion" type="password" name="request.PasswordConfirmacion" class="form-control" placeholder="Confirmar su contraseña"></div>
            </div><!-- row -->
            <div class="row row-xs mg-b-10">
                <div class="col-sm">
                    <select id="txtUsuario_CodigoPais" class="form-control select2">                     
                        <option value="54">Argentina (+54)</option>                      
                        <option value="591">Bolivia (+591)</option>                             
                        <option value="56">Chile (+56)</option>                
                        <option value="57">Colombia (+57)</option>                                                         
                        <option value="593">Ecuador (+593)</option>                                         
                        <option value="34">España (+34)</option>                                                                  
                        <option value="52">México (+52)</option>                            
                        <option value="595">Paraguay (+595)</option>
                        <option selected value="51">Perú (+51)</option>                       
                        <option value="598">Uruguay (+598)</option>
                        <option value="58">Venezuela (+58)</option>                      
                    </select>
                    <select id="txtUsuario_CodigoPais_ejemplos" class="form-control select2" style="display:none;">
                        <option value="190">Alaska</option>
                        <option value="355">Albania</option>
                        <option value="49">Alemania</option>
                        <option value="376">Andorra</option>
                        <option value="244">Angola</option>
                        <option value="966">Arabia Saudí</option>
                        <option value="213">Argelia</option>
                        <option value="54">Argentina</option>
                        <option value="374">Armenia</option>
                        <option value="61">Australia</option>
                        <option value="43">Austria</option>
                        <option value="973">Bahreim</option>
                        <option value="880">Bangladesh</option>
                        <option value="32">Bélgica</option>
                        <option value="591">Bolivia</option>
                        <option value="387">Bosnia</option>
                        <option value="55">Brasil</option>
                        <option value="359">Bulgaria</option>
                        <option value="238">Cabo Verde</option>
                        <option value="855">Camboya</option>
                        <option value="237">Camerún</option>
                        <option value="1">Canadá</option>
                        <option value="236">Centroafricana, Rep.</option>
                        <option value="420">Checa, Rep.</option>
                        <option value="56">Chile</option>
                        <option value="86">China</option>
                        <option value="357">Chipre</option>
                        <option value="57">Colombia</option>
                        <option value="242">Congo, Rep. del</option>
                        <option value="243">Congo, Rep. Democ.</option>
                        <option value="850">Corea, Rep. Democ.</option>
                        <option value="82">Corea, Rep.</option>
                        <option value="225">Costa de Marfil</option>
                        <option value="506">Costa Rica</option>
                        <option value="385">Croacia</option>
                        <option value="53">Cuba</option>
                        <option value="45">Dinamarca</option>
                        <option value="180">Dominicana, Rep.</option>
                        <option value="593">Ecuador (+593)</option>
                        <option value="20">Egipto</option>
                        <option value="503">El Salvador</option>
                        <option value="971">Emiratos Árabes Unidos</option>
                        <option value="421">Eslovaca, Rep.</option>
                        <option value="386">Eslovenia</option>
                        <option value="34">España</option>
                        <option value="1">Estados Unidos</option>
                        <option value="372">Estonia</option>
                        <option value="251">Etiopía</option>
                        <option value="63">Filipinas</option>
                        <option value="358">Finlandia</option>
                        <option value="33">Francia</option>
                        <option value="956">Gibraltar</option>
                        <option value="30">Grecia</option>
                        <option value="299">Groenlandia</option>
                        <option value="502">Guatemala
                        <option value="240">Guinea Ecuatorial</option>
                        <option value="509">Haití</option>
                        <option value="180">Hawai</option>
                        <option value="504">Honduras</option>
                        <option value="852">Hong Kong</option>
                        <option value="36">Hungría</option>
                        <option value="91">India</option>
                        <option value="62">Indonesia </option>
                        <option value="98">Irán</option>
                        <option value="964">Irak</option>
                        <option value="353">Irlanda</option>
                        <option value="354">Islandia</option>
                        <option value="972">Israel</option>
                        <option value="39">Italia</option>
                        <option value="187">Jamaica</option>
                        <option value="81">Japón</option>
                        <option value="962">Jordania</option>
                        <option value="254">Kenia</option>
                        <option value="965">Kuwait</option>
                        <option value="856">Laos</option>
                        <option value="371">Letonia</option>
                        <option value="961">Líbano</option>
                        <option value="231">Liberia</option>
                        <option value="218">Libia</option>
                        <option value="41">Liechtenstein</option>
                        <option value="370">Lituania</option>
                        <option value="352">Luxemburgo </option>
                        <option value="261">Madagascar </option>
                        <option value="60">Malasia</option>
                        <option value="356">Malta</option>
                        <option value="212">Marruecos</option>
                        <option value="596">Martinica</option>
                        <option value="222">Mauritania</option>
                        <option value="52">México</option>
                        <option value="373">Moldavia</option>
                        <option value="377">Mónaco</option>
                        <option value="976">Mongolia</option>
                        <option value="258">Mozambique</option>
                        <option value="264">Namibia</option>
                        <option value="977">Nepal</option>
                        <option value="505">Nicaragua</option>
                        <option value="234">Nigeria</option>
                        <option value="47">Noruega</option>
                        <option value="64">Nueva Zelanda</option>
                        <option value="31">Países Bajos </option>
                        <option value="92">Pakistán</option>
                        <option value="507">Panamá</option>
                        <option value="595">Paraguay</option>
                        <option selected value="51">Perú (+51)</option>
                        <option value="48">Polonia</option>
                        <option value="351">Portugal</option>
                        <option value="178">Puerto Rico</option>
                        <option value="974">Qatar</option>
                        <option value="44">Reino Unido</option>
                        <option value="40">Rumania</option>
                        <option value="7">Rusia</option>
                        <option value="378">San Marino</option>
                        <option value="221">Senegal</option>
                        <option value="65">Singapur</option>
                        <option value="963">Siria</option>
                        <option value="252">Somalia</option>
                        <option value="94">Sri-Lanka</option>
                        <option value="27">Sudáfrica</option>
                        <option value="249">Sudán</option>
                        <option value="46">Suecia</option>
                        <option value="41">Suiza</option>
                        <option value="66">Tailandia</option>
                        <option value="886">Taiwan</option>
                        <option value="255">Tanzania</option>
                        <option value="216">Túnez</option>
                        <option value="90">Turquía</option>
                        <option value="380">Ucrania</option>
                        <option value="256">Uganda</option>
                        <option value="598">Uruguay</option>
                        <option value="39">Vaticano</option>
                        <option value="58">Venezuela</option>
                        <option value="84">Vietnam</option>
                        <option value="967">Yemen</option>
                        <option value="381">Yugoslavia</option>
                        <option value="260">Zambia</option>
                        <option value="263">Zimbawe</option>
                    </select>
                </div>
                <div class="col-sm mg-t-10 mg-sm-t-0"><input id="txtUsuario_PhoneNumber" type="text" name="request.PhoneNumber" class="form-control" placeholder="Ingrese su whatsapp"></div>
            </div><!-- row -->

            <div class="row row-xs mg-b-10" style="display:none;">
                <div class="col-sm mg-t-10 mg-sm-t-0"><input id="txtUsuario_IdFacebook" type="text" name="request.txtUsuario_IdFacebook" class="form-control" placeholder=""></div>
            </div><!-- row -->

            <div class="row" style="padding-left:125px;padding-right:125px;">

            </div><!-- row -->
            <button onclick="RegistrarUsuario();" class="btn btn-primary btn-block" style="background-color:var(--colorPrincipal);border:1px solid var(--colorPrincipal);">Completar registro</button>

            <p class="mg-t-40 mg-b-0">Ya tienes una cuenta? <a style="color:var(--colorPrincipal)" href="@Url.Action("login","pg", new {id= HttpContext.Current.Request.Cookies["_SubDominio_PersonaFit"].Value})">Iniciar sesión</a></p>
        </div><!-- signin-box -->

    </div><!-- signin-wrapper -->

    <div id="modalAviso" class="modal fade">
        <div class="modal-dialog" role="document">
            <div class="modal-content tx-size-sm">
                <div class="modal-body tx-center pd-y-20 pd-x-20">
                    <button onclick="even_cerrarmodalAviso();" type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <i class="icon icon ion-ios-close-outline tx-100 tx-danger lh-1 mg-t-20 d-inline-block"></i>
                    <h4 class="tx-danger mg-b-20">Aviso: Este Nro de documento no tiene una membresia activa ó esta siendo usado por otro usuario!</h4>
                    <p class="mg-b-20 mg-x-20">Te recomendamos comunicarte con el administrador del centro de entrenamiento.</p>
                    <button onclick="even_cerrarmodalAviso();" type="button" style="background-color:var(--colorPrincipal);color:#fff;" class="btn pd-x-25" data-dismiss="modal" aria-label="Close">Aceptar</button>
                </div><!-- modal-body -->
            </div><!-- modal-content -->
        </div><!-- modal-dialog -->
    </div><!-- modal -->

    <div id="modalAvisoCorrecto" class="modal fade">
        <div class="modal-dialog" role="document">
            <div class="modal-content tx-size-sm">
                <div class="modal-body tx-center pd-y-20 pd-x-20">
                    <button onclick="even_cerrarmodalAviso();" type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <i class="icon icon ion-ios-checkmark-outline tx-100 tx-success lh-1 mg-t-20 d-inline-block"></i>
                    <h4 class="tx-success mg-b-20" id="lblTituloAvisoCorrecto"></h4>
                    <p class="mg-b-20 mg-x-20" id="lblDetalleAvisoCorrecto"></p>
                    <button onclick="even_cerrarmodalAviso();" type="button" style="background-color:var(--colorPrincipal);color:#fff;" class="btn pd-x-25" data-dismiss="modal" aria-label="Close">Aceptar</button>
                </div><!-- modal-body -->
            </div><!-- modal-content -->
        </div><!-- modal-dialog -->
    </div><!-- modal -->

    <div id="modalRegistroCompleto" class="modal fade">
        <div class="modal-dialog" role="document">
            <div class="modal-content tx-size-sm">
                <div class="modal-body tx-center pd-y-20 pd-x-20">
                    <i class="icon icon ion-ios-checkmark-outline tx-100 tx-success lh-1 mg-t-20 d-inline-block"></i>
                    <h4 class="tx-success mg-b-20" id="lblTituloRegistroCompleto"></h4>
                    <p class="mg-b-20 mg-x-20" id="lblDetalleRegistroCompleto"></p>
                    <a class="btn pd-x-25" style="background-color:var(--colorPrincipal);color:#fff;" href="@Url.Action("login","pg", new {id= HttpContext.Current.Request.Cookies["_SubDominio_PersonaFit"].Value})">
                        Muchas Gracias
                    </a>
                </div><!-- modal-body -->
            </div><!-- modal-content -->
        </div><!-- modal-dialog -->
    </div><!-- modal -->

</body>


@System.Web.Optimization.Scripts.Render("~/Content/app/lib/jquery/js/jquery.js")
@System.Web.Optimization.Scripts.Render("~/Content/app/lib/popper.js/js/popper.js")
@System.Web.Optimization.Scripts.Render("~/Content/app/lib/bootstrap/js/bootstrap.js")
@System.Web.Optimization.Scripts.Render("~/Content/app/js/slim.js")

@System.Web.Optimization.Scripts.Render("~/Scripts/plugins/jsKendo/angular.min.js")
@System.Web.Optimization.Scripts.Render("~/Scripts/plugins/jsKendo/kendo.all.min.js")

@System.Web.Optimization.Scripts.Render("~/Scripts/plugins/jquery-ui/jquery-ui.js")
@System.Web.Optimization.Scripts.Render("~/Scripts/plugins/jquery-ui/jquery-ui.min.js")

@System.Web.Optimization.Scripts.Render("~/Scripts/bootstrap-notify-master/bootstrap-notify.js")
@System.Web.Optimization.Scripts.Render("~/Scripts/bootstrap-notify-master/bootstrap-notify.min.js")
@System.Web.Optimization.Scripts.Render("~/Scripts/jsBootstrap/jquery.bootstrap-growl.js")

@System.Web.Optimization.Scripts.Render("~/Resource/UserControl.Helper.js")
@System.Web.Optimization.Scripts.Render("~/Scripts/jsFacebook/configuracionfacebook_appsfit.js?jasnjansj")

<script type="text/javascript">

    $(document).ready(function () {

    });
    
    function RegistrarUsuario() {
        var Accion = 'N';
        var entidad = {};
        entidad.FullName = ConvertToStringFromObject($('input[id="txtUsuario_Nombres"]').val()) + ' ' + ConvertToStringFromObject($('input[id="txtUsuario_Apellidos"]').val());
        entidad.Nombres = ConvertToStringFromObject($('input[id="txtUsuario_Nombres"]').val());
        entidad.Apellidos = ConvertToStringFromObject($('input[id="txtUsuario_Apellidos"]').val());
        entidad.UserName = ConvertToStringFromObject($('input[id="txtUsuario_Identificacion"]').val());//ConvertToStringFromObject($('input[id="txtUsuario_IdFacebook"]').val());
        entidad.PasswordHash = ConvertToStringFromObject($('input[id="txtUsuario_PasswordHash"]').val());
        entidad.PasswordConfirmacion = ConvertToStringFromObject($('input[id="txtUsuario_PasswordConfirmacion"]').val());
        entidad.Email = ConvertToStringFromObject($('input[id="txtUsuario_Email"]').val());
        entidad.PhoneNumber = ConvertToStringFromObject($('input[id="txtUsuario_PhoneNumber"]').val());
        entidad.Photo = ConvertToStringFromObject($('img[id="imgValidacion"]').attr('src'));
        entidad.Identificacion = ConvertToStringFromObject($('input[id="txtUsuario_Identificacion"]').val());
        //entidad.IdFacebook = ConvertToStringFromObject($('input[id="txtUsuario_IdFacebook"]').val());

        entidad.Accion = Accion;

         if (IsUndefinedOrNullOrEmpty($('input[id="txtUsuario_Nombres"]').val())) {
             $.bootstrapGrowl("Error, Falta ingresar su nombre!", { type: 'danger', width: 'auto' });
            return;
        } else if (IsUndefinedOrNullOrEmpty($('input[id="txtUsuario_Apellidos"]').val())) {
             $.bootstrapGrowl("Error, Falta ingresar sus apellidos!", { type: 'danger', width: 'auto' });
            return;
        } else if (IsUndefinedOrNullOrEmpty(entidad.UserName)) {
            $.bootstrapGrowl("Error, Falta ingresar su nro de identificación!", { type: 'danger', width: 'auto' });
            return;
         } else if (IsUndefinedOrNullOrEmpty(entidad.Identificacion)) {
             $.bootstrapGrowl("Error, Falta ingresar su DNI!", { type: 'danger', width: 'auto' });
             return;
         } else if (IsUndefinedOrNullOrEmpty(entidad.PasswordHash)) {
             $.bootstrapGrowl("Error, Falta confirmar su clave!", { type: 'danger', width: 'auto' });
             return;
         } else if (entidad.PasswordConfirmacion != entidad.PasswordHash) {
            $.bootstrapGrowl("Error, La clave de confirmación no es igual a la clave original!", { type: 'danger', width: 'auto' });
            return;
         } else if (IsUndefinedOrNullOrEmpty(entidad.Email)) {
            $.bootstrapGrowl("Error, Falta ingresar su correo!", { type: 'danger', width: 'auto' });
            return;
         } else if (IsUndefinedOrNullOrEmpty(entidad.PhoneNumber)) {
            $.bootstrapGrowl("Error, Falta ingresar su whatsapp!", { type: 'danger', width: 'auto' });
            return;
         } 

        entidad.PhoneNumber = ConvertToStringFromObject($('select[id="txtUsuario_CodigoPais"] option:selected').val()) + '' + entidad.PhoneNumber;

        $('button').attr('disabled', 'disabled');
        var metodoCorrecto = function (msg) {
            
            if (msg == 0) {
                $('button').removeAttr('disabled');
                $('#modalRegistroCompleto').modal('show');
                $('#lblTituloRegistroCompleto').html('Cuenta creada, felicitaciones ' + entidad.Nombres);
                $('#lblDetalleRegistroCompleto').html('Ahora cada vez que nos visites solo tienes que ingresar tu nro de indentificación y clave');
            } else if (msg == 1) {
                $('button').removeAttr('disabled');
                $('#modalAviso').modal('show');  
                //esta cuenta no tiene membresia activa
            }
            else {
                alert("error en el servidor");
            }
        };
        var metodoError = function (msg) {
            alert(msg);
        };
        var request = {
            request: entidad
        };
        LlamarAJAX("/pg/GuardarPersonaFit", request, metodoCorrecto, metodoError);

    }

    function even_cerrarmodalAviso() {
        $('#modalAvisoCorrecto').modal('hide');
        $('#modalAviso').modal('hide');
    }

    function even_cargarlogin() {
        var dominio = getCookie("_SubDominio_PersonaFit");
        window.location.href = "/pg/login/" + dominio;   
    }

    function getCookie(cname) {
        var name = cname + "=";
        var ca = document.cookie.split(';');
        for (var i = 0; i < ca.length; i++) {
            var c = ca[i].trim();
            if (c.indexOf(name) == 0) return c.substring(name.length, c.length);
        }
        return "";
    }


</script>


</html>
